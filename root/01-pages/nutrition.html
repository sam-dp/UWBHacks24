<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../11-resources/01-css/styles.css">
    <title>NutriPic</title>
</head>
<body onload="updateNutritionInfo()">
    <div class="main-container">
        <div class="food-section">
            <div class="food-name-list">
                <!-- Food names will be inserted here using JavaScript -->
            </div>
            <div class="food-image-container">
                <img id="food-image" src="../11-resources/02-images/01-upload/meal.jpg" alt="Food Image">
            </div>
        </div>
        <div class="nutrition-facts">
            <table id="nutrition-table">
                <!-- Nutrition data will be inserted here using JavaScript -->
            </table>
        </div>
    </div>

    <script>

        // Function to format the food name list
        function formatFoodNameList(foodNames) {
            const nameListDiv = document.querySelector('.food-name-list');
            nameListDiv.innerHTML = ''; // Clear existing content
            foodNames.forEach(name => {
            const nameDiv = document.createElement('div');
            nameDiv.textContent = name;
            nameListDiv.appendChild(nameDiv);
            });
        }
        
        // Function to populate the nutrition table with data
        function populateNutritionTable(nutritionData) {
            const nutritionTable = document.getElementById('nutrition-table');
            nutritionTable.innerHTML = ''; // Clear previous data
        
            // Calculate and append the total of each nutritional category
            const total = nutritionData.reduce((acc, item) => {
            acc.calories += item.calories;
            acc.total_fat += item.total_fat;
            acc.sodium += item.sodium;
            acc.carbs += item.carbs;
            acc.sugar += item.sugar;
            acc.protein += item.protein;
            return acc;
            }, { calories: 0, total_fat: 0, sodium: 0, carbs: 0, sugar: 0, protein: 0 });
        
            // Helper function to create and append a table row
            const appendRow = (header, value) => {
            const row = nutritionTable.insertRow();
            const headerCell = row.insertCell();
            const valueCell = row.insertCell();
            headerCell.textContent = header;
            valueCell.textContent = value.toFixed(2); // Rounds to 2 decimal places
            };
        
            // Append rows for each nutritional fact
            appendRow('Calories', total.calories);
            appendRow('Total Fat', total.total_fat);
            appendRow('Sodium', total.sodium);
            appendRow('Carbs', total.carbs);
            appendRow('Sugar', total.sugar);
            appendRow('Protein', total.protein);
        }
        


        // Fetch the nutritional data from the JSON file and call the functions to update the U

        function updateNutritionInfo() {
        fetch('../11-resources/selected_nutritional_info.json')
        .then(response => response.json())
        .then(data => {
            const foodNames = data.map(item => item.foodName);
            formatFoodNameList(foodNames);
            populateNutritionTable(data);
            document.getElementById('food-image').src = imageUrl;
        })
        .catch(error => {
            console.error('Error fetching nutritional info:', error);
            });
        }

        // Call the function to update nutrition info when the page loads
        window.onload = updateNutritionInfo;
    </script>
</body>
</html>